{"updatedAt":"2025-10-09T09:48:34.428Z","createdAt":"2025-10-09T09:48:34.428Z","id":"YK9VtYe5wPVPdVNs","name":"RAG: Chunking Contextual de Drive a Pinecone","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"53d02311-f2f0-434e-abe0-ed86fa65c203","name":"When clicking ‘Test workflow’","type":"n8n-nodes-base.manualTrigger","position":[1312,400],"typeVersion":1},{"parameters":{"options":{}},"id":"fa64d315-68ca-4997-8362-37f119c8f5be","name":"Loop Over Items","type":"n8n-nodes-base.splitInBatches","position":[2416,400],"typeVersion":3},{"parameters":{"options":{}},"id":"b4af98db-af15-4eef-a0e1-d28d34588f75","name":"OpenRouter Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","position":[1152,768],"typeVersion":1},{"parameters":{"mode":"insert","pineconeIndex":{"__rl":true,"mode":"list","value":"context-rag-test","cachedResultName":"context-rag-test"},"options":{}},"id":"7b991980-d86e-4aaf-bec1-6cf998be6e38","name":"Pinecone Vector Store","type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","position":[2096,752],"typeVersion":1},{"parameters":{},"id":"caf9bddd-1e8c-43de-8619-e4840c08859d","name":"Embeddings Google Gemini","type":"@n8n/n8n-nodes-langchain.embeddingsGoogleGemini","position":[2032,944],"typeVersion":1},{"parameters":{"options":{}},"id":"a1803d45-7c49-4dc6-9c58-18e23b6bc93c","name":"Default Data Loader","type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","position":[2240,944],"typeVersion":1},{"parameters":{"chunkSize":100000,"options":{}},"id":"a2d80ef8-6e3e-4300-94ce-896de1398901","name":"Recursive Character Text Splitter","type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","position":[2176,1072],"typeVersion":1},{"parameters":{"operation":"download","fileId":{"__rl":true,"mode":"list","value":"1gm0jxFTLuiWB5u4esEjzoCPImrVqu0AEMIKBIesTf9M","cachedResultUrl":"https://docs.google.com/document/d/1gm0jxFTLuiWB5u4esEjzoCPImrVqu0AEMIKBIesTf9M/edit?usp=drivesdk","cachedResultName":"Udit Rawat - Details"},"options":{"googleFileConversion":{"conversion":{"docsToFormat":"text/plain"}}}},"id":"6422423e-bb75-4cbd-bf92-a64250fe930b","name":"Get Document From Google Drive","type":"n8n-nodes-base.googleDrive","position":[1536,400],"typeVersion":3},{"parameters":{"operation":"text","options":{}},"id":"b7e89ccc-a238-4bab-a381-b627818bb0a3","name":"Extract Text Data From Google Document","type":"n8n-nodes-base.extractFromFile","position":[1760,400],"typeVersion":1},{"parameters":{"jsCode":"let split_text = \"—---------------------------—-------------[SECTIONEND]—---------------------------—-------------\";\nfor (const item of $input.all()) {\n item.json.section = item.json.data.split(split_text);\n item.json.document = JSON.stringify(item.json.section)\n}\nreturn $input.all();"},"id":"d947ba02-18e9-4a1e-ac3c-0790032a8099","name":"Split Document Text Into Sections","type":"n8n-nodes-base.code","position":[1968,400],"typeVersion":2},{"parameters":{"fieldToSplitOut":"section","options":{}},"id":"2efa7da7-f830-4280-890b-5fde3fd35466","name":"Prepare Sections For Looping","type":"n8n-nodes-base.splitOut","position":[2192,400],"typeVersion":1},{"parameters":{"content":"## Preparar Documento\nEsta sección se encarga de descargar el archivo desde Google Drive, dividir el texto en secciones detectando los separadores y prepararlas para el bucle.\n","height":280,"width":1300},"id":"eecdf92a-74e2-4683-9c49-9cb0df8f9345","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[1280,304],"typeVersion":1},{"parameters":{"content":"## Preparar contexto\nEn esta sección, el nodo **agente** preparará el contexto para una sección (fragmento de texto), que luego se pasará para la conversión en vectores junto con la propia sección.\n","height":360,"width":780},"id":"bc1efa72-ab8f-45e3-97f9-123d13bd8f28","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[1088,624],"typeVersion":1},{"parameters":{"agent":"conversationalAgent","promptType":"define","text":"=<document> \n{{ $('Split Document Text Into Sections').item.json.document }}\n</document> \nHere is the chunk we want to situate within the whole document \n<chunk> \n{{ $json.section }}\n</chunk> \nPlease give a short succinct context to situate this chunk within the overall document for the purposes of improving search retrieval of the chunk. Answer only with the succinct context and nothing else. ","options":{}},"id":"858215a3-6197-4794-b54d-65c462b34fbd","name":"AI Agent - Prepare Context","type":"@n8n/n8n-nodes-langchain.agent","position":[1328,752],"typeVersion":1.7},{"parameters":{"assignments":{"assignments":[{"id":"e5fb0381-5d23-46e2-a0d1-438240b80a3e","name":"=section_chunk","type":"string","value":"={{ $json.output }}. {{ $('Loop Over Items').item.json.section }}"}]},"options":{}},"id":"19b65403-8b2c-4e8d-8c00-9bb02817afef","name":"Concatenate the context and section text","type":"n8n-nodes-base.set","position":[1680,752],"typeVersion":3.4},{"parameters":{"content":"## Convertir texto en vectores\nEn este paso, el nodo **Pinecone** convierte el texto proporcionado en vectores utilizando **Google Gemini** y los almacena en la base de datos vectorial de **Pinecone**.\n","height":600,"width":580},"id":"755bc387-aeca-4b4a-a5e8-ea2140ff59f8","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[1952,624],"typeVersion":1},{"parameters":{"content":"## Demostración en Video\n[![Miniatura del Video](https://img.youtube.com/vi/qBeWP65I4hg/maxresdefault.jpg)](https://www.youtube.com/watch?v=qBeWP65I4hg)\n","height":300,"width":400},"id":"369c0a0e-842a-495a-a188-fdb968e083ba","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[848,272],"typeVersion":1}],"connections":{"Loop Over Items":{"main":[[],[{"node":"AI Agent - Prepare Context","type":"main","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Pinecone Vector Store","type":"ai_document","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"AI Agent - Prepare Context","type":"ai_languageModel","index":0}]]},"Pinecone Vector Store":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Embeddings Google Gemini":{"ai_embedding":[[{"node":"Pinecone Vector Store","type":"ai_embedding","index":0}]]},"AI Agent - Prepare Context":{"main":[[{"node":"Concatenate the context and section text","type":"main","index":0}]]},"Prepare Sections For Looping":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Get Document From Google Drive":{"main":[[{"node":"Extract Text Data From Google Document","type":"main","index":0}]]},"Recursive Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader","type":"ai_textSplitter","index":0}]]},"Split Document Text Into Sections":{"main":[[{"node":"Prepare Sections For Looping","type":"main","index":0}]]},"When clicking ‘Test workflow’":{"main":[[{"node":"Get Document From Google Drive","type":"main","index":0}]]},"Extract Text Data From Google Document":{"main":[[{"node":"Split Document Text Into Sections","type":"main","index":0}]]},"Concatenate the context and section text":{"main":[[{"node":"Pinecone Vector Store","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"7278daba-9334-4f3a-80df-68b3596d7c40","triggerCount":0,"shared":[{"updatedAt":"2025-10-09T09:48:34.432Z","createdAt":"2025-10-09T09:48:34.432Z","role":"workflow:owner","workflowId":"YK9VtYe5wPVPdVNs","projectId":"prlZ3bTXg0wKi0D1"}],"tags":[{"updatedAt":"2025-10-09T08:32:14.448Z","createdAt":"2025-10-09T08:32:14.448Z","id":"2ft3cuPlaPbpQkDb","name":"The AI Blueprint Plus"}]}